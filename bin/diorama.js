"use strict";!function(e){function t(e,t){function n(e){e&&i--,0===i&&t(o)}var i=0,o={};e.models&&(o.models={},Object.keys(e.models).forEach(function(t){var a=e.models[t];if(r.models[a])o.models[t]=r.models[a].clone();else if(/\.gltf$/.test(a)){i++;var s=new THREE.glTFLoader;s.load(a,function(e){r.models[a]=e.scene.children[0].children[0],o.models[t]=r.models[a].clone(),n(!0)})}})),e.textures&&(o.textures={},Object.keys(e.textures).forEach(function(t){var a=e.textures[t];if(r.textures[a])o.textures[t]=r.textures[a].clone();else{i++;var s=new THREE.TextureLoader;s.load(a,function(e){r.textures[a]=e,o.textures[t]=r.textures[a].clone(),n(!0)},null,function(e){console.error(e),n(!0)})}})),e.videos&&(o.videos={},Object.keys(e.videos).forEach(function(t){var n=e.videos[t];if(r.videos[n])o.videos[t]=r.videos[n].clone();else{var i=document.createElement("video");i.autoplay=!0,i.loop=!0,i.src=n,i.style.display="none",document.body.appendChild(i);var a=new THREE.VideoTexture(i);a.minFilter=THREE.LinearFilter,a.magFilter=THREE.LinearFilter,a.format=THREE.RGBFormat,r.videos[n]=a,o.videos[t]=r.videos[n]}})),n()}var r={models:{},textures:{},videos:{}};e.loadAssets=t}(window.Diorama=window.Diorama||{});var _slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(e){var t,r,n,i=new THREE.Scene;e.load=function(o){function a(){o.forEach(function(t){var r=new THREE.Object3D;i.add(r),e.loadAssets(t.assets,function(e){t.initialize(n,r,e)})}),window.requestAnimationFrame(function e(n){window.requestAnimationFrame(e),i.updateAllBehaviors(),t.render(i,r)})}altspace.inClient?(t=altspace.getThreeJSRenderer(),Promise.all([altspace.getEnclosure(),altspace.getSpace()]).then(function(e){var t=_slicedToArray(e,2),r=t[0],o=t[1];n=Object.freeze({innerHeight:r.innerHeight,innerWidth:r.innerWidth,innerDepth:r.innerDepth,pixelsPerMeter:r.pixelsPerMeter,sid:o.sid,name:o.name,templateSid:o.templateSid}),i.scale.multiplyScalar(r.pixelsPerMeter),a()})):(t=new THREE.WebGLRenderer,t.setSize(720,720),t.setClearColor(8947848),document.body.appendChild(t.domElement),r=new THREE.PerspectiveCamera(90,1,.01,1e4),r.position.set(0,-10,20),r.rotation.set(0,Math.PI,0),i.add(r),altspace.utilities.shims.cursor.init(i,r,{renderer:t}),n=Object.freeze({innerWidth:1024,innerHeight:1024,innerDepth:1024,pixelsPerMeter:1024/3,sid:"browser",name:"browser",templateSid:"browser"}),a())}}(window.Diorama=window.Diorama||{});